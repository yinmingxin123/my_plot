# 📦 打包说明

## 准备工作

### 1. 安装打包依赖

```bash
cd E:\python_projects\my_plot
pip install pyinstaller
```

### 2. 确保所有依赖已安装

```bash
pip install -r requirements.txt
```

## 打包步骤

### 方法一：使用自动打包脚本（推荐）

```bash
python build_exe.py
```

脚本会自动：
- 检查并安装 PyInstaller
- 清理旧的构建文件
- 执行打包命令
- 显示打包结果

### 方法二：手动打包

```bash
pyinstaller --name=交互式绘图工具 --onedir --console --icon=NONE --add-data=app.py;. --add-data=sample_data.csv;. --hidden-import=streamlit --hidden-import=pandas --hidden-import=plotly --hidden-import=openpyxl --hidden-import=streamlit.web.cli --hidden-import=streamlit.runtime.scriptrunner.magic_funcs --collect-all=streamlit --collect-all=plotly launcher.py
```

## 打包结果

打包完成后，会在 `dist` 文件夹中生成：

```
dist/
└── 交互式绘图工具/
    ├── 交互式绘图工具.exe  # 主程序
    ├── app.py              # Streamlit应用
    ├── sample_data.csv     # 示例数据
    └── _internal/          # 依赖文件夹（包含所有库文件）
```

## 使用方法

### 本地使用

1. 进入 `dist/交互式绘图工具/` 文件夹
2. 双击 `交互式绘图工具.exe`
3. 等待控制台窗口显示启动信息
4. 浏览器会自动打开应用页面

### 分发给他人

**方式一：压缩整个文件夹**

1. 将 `dist/交互式绘图工具/` 整个文件夹压缩成 zip
2. 发送给其他用户
3. 用户解压后双击 `交互式绘图工具.exe` 即可使用

**方式二：使用网盘分享**

1. 上传 `dist/交互式绘图工具/` 文件夹到网盘
2. 分享下载链接
3. 用户下载后解压使用

## 注意事项

### ⚠️ 重要提示

1. **不要单独复制 exe 文件**
   - exe 需要 `_internal` 文件夹中的依赖
   - 必须保持整个文件夹结构完整

2. **杀毒软件可能误报**
   - PyInstaller 打包的程序可能被某些杀毒软件误报
   - 添加到信任列表即可

3. **防火墙提示**
   - 首次运行时可能提示防火墙警告
   - 允许访问即可（应用需要启动本地服务器）

4. **端口占用**
   - 如果提示端口被占用，关闭其他占用端口的程序
   - 启动器会自动寻找可用端口

### 💡 优化建议

1. **减小体积**（可选）
   - 使用 UPX 压缩：`pip install upx` 然后添加 `--upx-dir` 参数
   - 但可能增加杀毒软件误报概率

2. **添加图标**
   - 准备一个 `.ico` 图标文件
   - 修改 `build_exe.py` 中的 `--icon=NONE` 为 `--icon=your_icon.ico`

3. **隐藏控制台**（不推荐新手）
   - 将 `--console` 改为 `--windowed`
   - 但这样看不到错误信息，不利于调试

## 系统要求

### 用户系统要求

- 操作系统：Windows 7/8/10/11（64位）
- 内存：至少 2GB
- 磁盘空间：至少 500MB

### 无需用户安装

- ✅ 不需要安装 Python
- ✅ 不需要安装任何依赖库
- ✅ 双击即可运行

## 故障排除

### 问题1：exe 无法启动

**解决方法：**
- 确保整个文件夹完整
- 检查是否被杀毒软件拦截
- 以管理员身份运行

### 问题2：浏览器没有自动打开

**解决方法：**
- 查看控制台窗口显示的地址
- 手动在浏览器中打开该地址
- 通常是 `http://localhost:端口号`

### 问题3：提示找不到 app.py

**解决方法：**
- 确保 app.py 在同一文件夹下
- 重新打包，确保 `--add-data` 参数正确

### 问题4：打包时出错

**解决方法：**
- 确保所有依赖已正确安装
- 尝试升级 PyInstaller：`pip install --upgrade pyinstaller`
- 清理缓存后重试：删除 `build`、`dist` 文件夹

## 更新程序

如果修改了代码需要重新打包：

1. 修改 `app.py` 或其他文件
2. 重新运行 `python build_exe.py`
3. 新的 exe 会在 `dist` 文件夹中生成
4. 替换旧版本即可

## 文件大小参考

打包后的文件夹大小约：
- 完整版本：约 150-300 MB
- 主要是 Streamlit 和 Plotly 库比较大

## 技术支持

如有问题，请检查：
1. Python 版本是否为 3.8-3.11
2. 所有依赖是否正确安装
3. PyInstaller 版本是否最新

---

**祝打包顺利！** 🎉

